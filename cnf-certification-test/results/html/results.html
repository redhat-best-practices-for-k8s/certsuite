<!DOCTYPE html>
<html lang="en">

<head>
  <title>CNF Certification Test Results</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" integrity="sha256-2TnSHycBDAm2wpZmgdi0z81kykGPJAkiUY+Wf97RbvY=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" integrity="sha256-X0cPqbNml7z/f/z7c1HiTdJ2aSO4QmaAMDnESV5n7fE=" crossorigin="anonymous">

  <style>.accordion-button:not(.collapsed){background-color:#9935dc;color:#fff}.btn-purple.collapsed,tpurple,tred{background-color:#9935dc;color:#fff}li.dropdown-menu{background-color:#fff}tg{background-color:#28a745}tred{background-color:#dc3545}ty{background-color:#ffc107}tgy{background-color:#ced4da}body{font-family:sans-serif}ul{list-style:none;padding-left:1.75em}ul li{border-bottom-left-radius:.75em;border-top-left-radius:.75em;margin:2px 0;position:relative}ul li a,ul li span{display:inline-block}ul li a{border-radius:50%;color:#000;height:1.5em;left:-1.5em;line-height:1.5em;position:absolute;text-align:center;text-decoration:none;width:1.5em}ul li a.plus{background-color:#77aeff}ul li a,ul li a.minus{background-color:#eee}ul li a:active{top:1px}ul li span{margin:.25em .5em}.top-right{font-size:small;position:fixed;right:1em;top:1em}progress{width:0%}</style>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.4/dayjs.min.js" integrity="sha256-NTsR4SOm3YHfJrmrmvBtEYqfQ6jQ5yvEKMhgQe3DIl0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.4/plugin/duration.min.js" integrity="sha256-6rug74IKp6v/8WINJxMw33zXo8NVOdRw/5Ib21ZzwU4=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-0upsHgyryiDRjpJLJaHNAYfDi6fDP2CrBuGwQCubzbU=" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/ansi_up@5.1.0/ansi_up.js" integrity="sha256-tarXJ7M5ReiY9qzPiDQdY5EZcrMil9PaXwnVbAgWbo8=" crossorigin="anonymous"></script>
  <script>const expectedClaimVersion="v0.1.0";let claimGlobal,feedbackGlobal,isResultTabActive=!1,uuidNode=1;function selectScenarioHandler(){!0===isResultTabActive&&resfreshResultsTabContent()}function resfreshResultsTabContent(){hideAllResultsTabObjects(),enableSendDownloadButton(),isResultTabActive=!0;const e=document.getElementById("selectScenarioComboBox");"all"===e.options[e.selectedIndex].value?showAll():(document.getElementById("results-table").setAttribute("hidden","hidden"),document.getElementById("myCheck-result").removeAttribute("hidden"),document.getElementById("optional-checkbox").removeAttribute("hidden"),document.getElementById("myCheck-mandatory").removeAttribute("hidden"),document.getElementById("mandatory-checkbox").removeAttribute("hidden")),makeResultsTableVisible("optional"),makeResultsTableVisible("mandatory")}function makeResultsTableVisible(e){const t=document.getElementById(e+"-checkbox"),n=document.getElementById("selectScenarioComboBox"),o=n.options[n.selectedIndex].value;"faredge"===o&&(!0===t.checked?document.getElementById(e+"-far-edge-table").removeAttribute("hidden"):document.getElementById(e+"-far-edge-table").setAttribute("hidden","hidden")),"telco"===o&&(!0===t.checked?document.getElementById(e+"-telco-table").removeAttribute("hidden"):document.getElementById(e+"-telco-table").setAttribute("hidden","hidden")),"nontelco"===o&&(!0===t.checked?document.getElementById(e+"-non-telco-table").removeAttribute("hidden"):document.getElementById(e+"-non-telco-table").setAttribute("hidden","hidden")),"extended"===o&&(!0===t.checked?document.getElementById(e+"-extended-table").removeAttribute("hidden"):document.getElementById(e+"-extended-table").setAttribute("hidden","hidden"))}function filterTestCasesBasedOnStateHandler(e,t,n,o){const l=document.getElementById("filter-"+o+"-"+n+"-"+t),d=l.checked;d?l.setAttribute("checked",""):l.removeAttribute("checked");const a=e.replace(/#/g,""),s=document.getElementById(a).getElementsByClassName("accordion-item");for(let e=0;e<s.length;e++){const t=s[e];t.getAttribute("data-id")===n&&(!0===d?t.removeAttribute("hidden"):t.setAttribute("hidden","hidden"))}}function showAll(){document.getElementById("mandatory-far-edge-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-telco-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-non-telco-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-extended-table").setAttribute("hidden","hidden"),document.getElementById("optional-far-edge-table").setAttribute("hidden","hidden"),document.getElementById("optional-telco-table").setAttribute("hidden","hidden"),document.getElementById("optional-non-telco-table").setAttribute("hidden","hidden"),document.getElementById("optional-extended-table").setAttribute("hidden","hidden"),document.getElementById("results-table").removeAttribute("hidden")}function enableSendDownloadButton(){document.getElementById("download").removeAttribute("hidden"),document.getElementById("downloadjsonHandler").removeAttribute("hidden"),document.getElementById("UploadFeedback").removeAttribute("hidden")}function hideAllResultsTabObjects(){isResultTabActive=!1,document.getElementById("mandatory-far-edge-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-non-telco-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-extended-table").setAttribute("hidden","hidden"),document.getElementById("mandatory-telco-table").setAttribute("hidden","hidden"),document.getElementById("optional-far-edge-table").setAttribute("hidden","hidden"),document.getElementById("optional-non-telco-table").setAttribute("hidden","hidden"),document.getElementById("optional-extended-table").setAttribute("hidden","hidden"),document.getElementById("optional-telco-table").setAttribute("hidden","hidden"),document.getElementById("optional-checkbox").setAttribute("hidden","hidden"),document.getElementById("mandatory-checkbox").setAttribute("hidden","hidden"),document.getElementById("download").setAttribute("hidden","hidden"),document.getElementById("downloadjsonHandler").setAttribute("hidden","hidden"),document.getElementById("UploadFeedback").setAttribute("hidden","hidden"),document.getElementById("myCheck-result").setAttribute("hidden","hidden"),document.getElementById("myCheck-mandatory").setAttribute("hidden","hidden")}function fillVersionsElement(e,t){$(t).empty(),$('<thead><tr><th scope="col">Component</th><th scope="col">Version</th></tr></thead><tbody>').appendTo($(t));for(const n in e)$("<tr><td><b>"+n+"</b></td><td>"+e[n]+"</td></tr>").appendTo($(t));$("</tbody>").appendTo($(t))}function getClaimVersion(e){const t=e.claimFormat;if(void 0===t)return"nil - claimFormat version not present in claim file";const n=t.match(/(v[0-9]\.[0-9]\.[0-9])/);return null!==n&&n.length>1?n[1]:"nil - claimFormat version is not in a valid format, check claim file"}function fillMetadata(e,t){$(t).empty(),$("<tbody>").appendTo($(t));for(const n in e)$("<tr><td><b>"+n+"</b></td><td>"+e[n]+"</td></tr>").appendTo($(t));$("</tbody>").appendTo($(t))}$(document).ready((function(){"undefined"!=typeof initialjson&&(claimGlobal=initialjson),"undefined"!=typeof feedback&&(feedbackGlobal=feedback);const e=window.location.search,t=new URLSearchParams(e),n=t.get("claimfile"),o=t.get("feedback");console.log("claimfile via url:",n),console.log("feedbackfile via url:",o),fetchRenderClaimFile(n),fetchRenderFeedbackFile(o),void 0!==claimGlobal&&renderResultsWithModal();document.getElementById("feedbackFile").addEventListener("change",(function(){const e=this.files;if(e.length){const t=new FileReader;t.addEventListener("load",(e=>{fillFeedback(JSON.parse(t.result))})),t.readAsText(e[0])}this.value=null}),!1);document.getElementById("formFile").addEventListener("change",handleFiles,!1)}));const tableNameMap={faredge:"Far-Edge",telco:"Telco",nontelco:"Non-Telco",extended:"Extended",all:"All"};function getTestCaseStats(e,t){let n=0,o=0,l=0,d=0,a=0,s=0,i=0,c=0,r=0;for(const u in e){const m=e[u][0];let b=m.categoryClassification.FarEdge;"telco"===t&&(b=m.categoryClassification.Telco),"nontelco"===t&&(b=m.categoryClassification.NonTelco),"extended"===t&&(b=m.categoryClassification.Extended),"passed"===m.state?"Mandatory"===b||"all"===t?(n++,o++):s++:"skipped"===m.state?"Mandatory"===b||"all"===t?(n++,l++):i++:"failed"===m.state?"Mandatory"===b||"all"===t?(n++,d++):c++:"aborted"===m.state&&("Mandatory"===b||"all"===t?(n++,a++):r++)}return{testsTotal:n,testsPassed:o,testsSkipped:l,testsFailed:d,testsAborted:a,testsPassedOptional:s,testsSkippedOptional:i,testsFailedOptional:c,testsAbortedOptional:r}}function generateTestCasesStatsElement(e,t,n,o,l,d,a,s,i){let c="";return c="all"===t?'<thead><tr><th style="width:15%" scope="col">Test summary ('+tableNameMap[t]+')</th><th scope="col">Test feedback</th></tr></thead><tbody>':'<thead><tr><th style="width:15%" scope="col">'+n+" Test  summary ("+tableNameMap[t]+')</th><th scope="col">Test feedback</th></tr></thead><tbody>',c+='<tr><td class="align-top"><b>Total:</b> '+l+"<br><b><tg>Passed:</tg></b> "+d+" ",c+='<input type="checkbox" id="filter-'+n+"-passed-"+t+'" checked onclick="filterTestCasesBasedOnStateHandler(\''+e+"','"+t+"', 'passed','"+n+"' )\" >",c+="<br><b><tgy>Skipped:</tgy></b> "+a+" ",c+='<input type="checkbox" id="filter-'+n+"-skipped-"+t+'" checked onclick="filterTestCasesBasedOnStateHandler(\''+e+"','"+t+"', 'skipped', '"+n+"' )\" >",c+="<br><b><"+o+">Failed:</"+o+"></b> "+s+" ",c+='<input type="checkbox" id="filter-'+n+"-failed-"+t+'" checked onclick="filterTestCasesBasedOnStateHandler(\''+e+"','"+t+"', 'failed', '"+n+"' )\" >",c+="<br><b><tpurple>Aborted:</tpurple></b> "+i+" ",c+='<input type="checkbox" id="filter-'+n+"-aborted-"+t+'" checked onclick="filterTestCasesBasedOnStateHandler(\''+e+"','"+t+"', 'aborted', '"+n+"' )\" >",c+="</td><td>",c+='<div class="accordion" id="results-accordion">',c}function generateTestcaseSingleResultElement(e,t,n,o){const l=new AnsiUp;let d="";const a=e.state;let s="";"passed"===a?s="bg-success text-white":"skipped"===a?s="bg-dark-subtle text-black":"aborted"===a?s="btn-purple":(s="bg-warning text-white","Optional"===o&&"all"!==t||(s="bg-danger text-white"));const i="collapse"+n,c="heading"+n;d+='<div data-id="'+a+'" class="accordion-item"><h2 class="accordion-header" id="'+c+'"><button class="accordion-button collapsed '+s+'" type="button" data-bs-toggle="collapse" data-bs-target="#'+i+'" aria-expanded="true" aria-controls="'+i+'">',d+=e.testID.id+"</button></h2>",d+='<div id="'+i+'" class="accordion-collapse collapse" aria-labelledby="'+c+'">',d+='<div class="accordion-body" >',d+="<h1>Results</h1>",d+='<div class="table-responsive">',d+='<table id="myTable-'+e.testID.id+'" class="table table-bordered"><thead><tr>',d+="<th>Test ID</th>",d+='<th class="th-lg">Test Text</th>',d+="<th>Duration</th>",d+="<th>State</th>",d+="<th>Test output</th>",d+="</tr></thead><tbody>",dayjs.extend(window.dayjs_plugin_duration);const r=dayjs.duration(e.duration/1e6).format("D[d] H[h] m[m] s[s] SSS[ms]");let u="";"skipped"===e.state&&(u=e.failureReason,""===u&&(u="Test case skipped by configuration"),u=" ( "+u+" )"),d+='<tr><td  style="white-space: nowrap;">'+e.testID.id+"</td>",d+='<td class="th-lg">'+e.catalogInfo.description.replace(/\n/g,"<br>")+"</td>",d+="<td>"+r+"</td>",d+="<td><b>"+e.state+"</b>"+u+"</td>",d+="<td>"+l.ansi_to_html(ExtractLog(e.capturedTestOutput)).replace(/\n/g,"<br>")+"</td></tr>";const m=NonCompliantReasonTextToJson(e.capturedTestOutput),b=CompliantReasonTextToJson(e.capturedTestOutput);return d+="</tbody></table></div>",d+="<h1>Feedback</h1><label>Write your feedback for "+e.testID.id+" test case</label>",d+='<textarea style="width: 100%; margin: 0 auto;" rows = "5" id="source-'+t+"-"+e.testID.id+'" type="text"></textarea>',d+="<h1>Non-Compliant objects</h1>",d+=createReasonTableAllTypes(m),d+="<h1>Compliant objects</h1>",d+=createReasonTableAllTypes(b),d+="</div></div></div>",d}function fillResults(e,t,n,o){const l=Object.entries(e).sort((function(e,t){const n=e[1][0].testID.id+e[1][0].state,o=t[1][0].testID.id+t[1][0].state;return n.localeCompare(o)})),d=Object.fromEntries(l),a=getTestCaseStats(e,o);let s=generateTestCasesStatsElement(t,o,"mandatory","tred",a.testsTotal,a.testsPassed,a.testsSkipped,a.testsFailed,a.testsAborted),i=generateTestCasesStatsElement(n,o,"optional","ty",a.testsTotal,a.testsPassedOptional,a.testsSkippedOptional,a.testsFailedOptional,a.testsAbortedOptional),c=1;for(const t in d){const n=e[t][0];let l=n.categoryClassification.FarEdge;"telco"===o&&(l=n.categoryClassification.Telco),"nontelco"===o&&(l=n.categoryClassification.NonTelco),"extended"===o&&(l=n.categoryClassification.Extended),c+=1;const d=generateTestcaseSingleResultElement(n,o,c,l);"Mandatory"===l||"all"===o?s+=d:i+=d}s+="</div></td></tr></tbody>",i+="</div></td></tr></tbody>",$(s).appendTo($(t)),"all"!==o&&$(i).appendTo($(n))}function fillFeedback(e){for(const t in e){const n=document.getElementById(t);null!==n&&(n.textContent=n.value,n.textContent=e[t],n.value=e[t])}}function saveTextAreaContent(e){const t=document.getElementById("selectScenarioComboBox"),n="source-"+t.options[t.selectedIndex].value+"-"+e;console.log(n);const o=document.getElementById(n).value;document.getElementById(n).textContent=o}function handleFiles(){const e=this.files;if(e.length){const t=new FileReader;t.addEventListener("load",(e=>{claimGlobal=JSON.parse(t.result),renderResultsWithModal()})),t.readAsText(e[0])}}function renderResultsWithModal(){const e=getClaimVersion(claimGlobal.claim.versions),t=document.getElementById("modalBody");if(expectedClaimVersion!==e){$("#staticBackdrop").modal("show"),t.textContent="Unsupported claim format. Expecting: "+expectedClaimVersion+" but got: "+e;document.getElementById("continueLoadingClaim").addEventListener("click",renderResults)}else renderResults()}function fetchRenderClaimFile(e){null!==e&&fetch(e).then((e=>{if(!e.ok)throw new Error(`HTTP error, status = ${e.status}`);return e.json()})).then((e=>{claimGlobal=e,renderResultsWithModal()})).catch((e=>{console.log(`Error: ${e.message}`)}))}function fetchRenderFeedbackFile(e){null!==e&&fetch(e).then((e=>{if(!e.ok)throw new Error(`HTTP error, status = ${e.status}`);return e.json()})).then((e=>{feedbackGlobal=e,renderResultsWithModal()})).catch((e=>{console.log(`Error: ${e.message}`)}))}function renderResults(){if(void 0!==claimGlobal){let e=formatForFastTreeview(0,claimGlobal.claim.configurations,[]);addOrphans(e.objectArray,"#config-table"),e=formatForFastTreeview(0,claimGlobal.claim.nodes,[]),addOrphans(e.objectArray,"#nodes-table"),fillMetadata(claimGlobal.claim.metadata,"#metadata-table"),fillVersionsElement(claimGlobal.claim.versions,"#versions-table"),fillResults(claimGlobal.claim.results,"#results-table","#optional-","all"),fillResults(claimGlobal.claim.results,"#mandatory-far-edge-table","#optional-far-edge-table","faredge"),fillResults(claimGlobal.claim.results,"#mandatory-telco-table","#optional-telco-table","telco"),fillResults(claimGlobal.claim.results,"#mandatory-non-telco-table","#optional-non-telco-table","nontelco"),fillResults(claimGlobal.claim.results,"#mandatory-extended-table","#optional-extended-table","extended"),void 0!==feedbackGlobal&&fillFeedback(feedbackGlobal)}}function linkToStyle(e){const t=[],n=e.sheet;let o;try{o=n.cssRules||n.rules}catch(e){return console.log(e),null}for(let e=0;e<o.length;++e){const n=o[e];".collapse:not(.show)"!==o[e].selectorText&&t.push(n.cssText)}const l=document.createElement("style");return l.type="text/css",l.appendChild(document.createTextNode(t.join("\r\n"))),l}function getHtmlResults(){let e=document.getElementById("selectScenarioComboBox");const t=document.implementation.createHTMLDocument(),n=t.head,o=t.body;e=document.getElementById("selectScenarioComboBox"),insertResults(o,"mandatory"),"all"!==e.value&&insertResults(o,"optional"),document.querySelectorAll("link[rel='stylesheet']").forEach((function(e){const t=linkToStyle(e);null!==t&&n.insertBefore(t,n.firstChild)})),document.querySelectorAll("style").forEach((function(e){const t=e.cloneNode(!0);n.insertBefore(t,n.firstChild)}));const l=t.querySelectorAll('input[type="checkbox"]'),d=t.querySelectorAll("textarea");return l.forEach((e=>{e.setAttribute("disabled","disabled")})),d.forEach((e=>{e.readOnly=!0})),t.documentElement.outerHTML}function downloadjsonHandler(){const e={},t=["all","telco","nontelco","extended","faredge"];for(const n in claimGlobal.claim.results)for(let o=0;o<t.length;o++){const l="source-"+t[o]+"-"+n,d=document.getElementById(l);null!==d&&(e[l]=d.value)}const n=document.createElement("a");n.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),n.setAttribute("download","feedback.json"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function download(){for(const e in claimGlobal.claim.results)saveTextAreaContent(e);const e=document.createElement("a");e.setAttribute("href","data:text/html;charset=UTF-8,"+encodeURIComponent(getHtmlResults())),e.setAttribute("download","results-feedback"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}function insertResults(e,t){const n=document.getElementById(t+"-checkbox"),o=document.getElementById("selectScenarioComboBox").value;let l=document.getElementById("results-table");"faredge"===o&&!0===n.checked&&(l=document.getElementById(t+"-far-edge-table")),"telco"===o&&!0===n.checked&&(l=document.getElementById(t+"-telco-table")),"nontelco"===o&&!0===n.checked&&(l=document.getElementById(t+"-non-telco-table")),"extended"===o&&!0===n.checked&&(l=document.getElementById(t+"-extended-table"));const d=l.cloneNode(!0);e.appendChild(d)}function NonCompliantReasonTextToJson(e){const t=/NonCompliantObjectsOut":(\[.*])/.exec(e);let n;if(t){const e=t[1];n=JSON.parse(e)}return n}function CompliantReasonTextToJson(e){const t=/"CompliantObjectsOut":(\[.*]),"NonCompliantObjectsOut"/.exec(e);let n;if(t){const e=t[1];n=JSON.parse(e)}return n}function ExtractLog(e){const t=/(.*){"CompliantObjectsOut"/.exec(e);let n=e;return t&&(n=t[1]),n}function createTypeList(e){const t=new Map;return void 0===e||e.forEach((function(e){t.set(e.ObjectType,!0)})),t}function createReasonTableAllTypes(e){const t=createTypeList(e);let n="";return t.forEach((function(t,o){n+="<h2> Type: "+o+"</h2>",n+='<div class="table-responsive">',n+=createReasonTableOneType(e,o),n+="</div>"})),n}function createReasonTableOneType(e,t){if(void 0===e)return"";const n=document.createElement("table");n.setAttribute("border","1"),n.setAttribute("class","table table-striped");let o=!0;const l=document.createElement("tbody");return e.forEach((function(e){if(e.ObjectType!==t)return;if(o){const t=document.createElement("thead"),l=document.createElement("tr");null!==e.ObjectFieldsKeys&&Object.values(e.ObjectFieldsKeys).forEach((function(e){const t=document.createElement("th");t.textContent=e,l.appendChild(t)})),t.appendChild(l),n.appendChild(t),o=!1}const d=document.createElement("tr");null!==e.ObjectFieldsValues&&Object.values(e.ObjectFieldsValues).forEach((function(e){const t=document.createElement("td");t.textContent=e,d.appendChild(t)})),l.appendChild(d)})),n.appendChild(l),n.outerHTML}function isStringInt(e){return/^\d+$/.test(e)}function formatForFastTreeview(e,t,n){let o="",l="";for(const d in t){if(null===t[d]||"managedFields"===d)continue;"name"===d.toLowerCase()&&(o=t[d]),"namespace"===d.toLowerCase()&&(l=t[d]);const a=uuidNode++;if(Array.isArray(t[d])||"[object Object]"===t[d].toString()){const s=formatForFastTreeview(a,t[d],n),i=s.name,c=s.namespace;""!==i&&(o=i,l=c);let r=d;isStringInt(d)&&""!==o&&(r="ns:"+l+" name:"+o,o="",l=""),n.push({id:a.toString(),name:r,parent:e.toString()})}else n.push({id:a.toString(),name:d+" : "+t[d],parent:e.toString()})}return{objectArray:n,name:o,namespace:l}}function orphans(e){return e.filter((function(e){return"0"===e.parent}))}function hasChildren(e,t){return e.some((function(e){return e.parent===t}))}function getChildren(e,t){return e.filter((function(e){return e.parent===t}))}function generateListItem(e,t){const n=document.createElement("li");if(n.id="item-"+t.id,hasChildren(e,t.id)){const t=document.createElement("a");t.href="#",t.textContent="+",t.classList.add("plus"),t.title="hold shift to expand sub tree",t.addEventListener("click",expand.bind(null,e),{once:!0}),n.appendChild(t)}const o=document.createElement("span");return o.textContent=t.name,n.appendChild(o),n}function expand(e,t){t.preventDefault(),t.stopPropagation();const n=t.target,o=n.parentElement,l=o.id.replace("item-",""),d=getChildren(e,l).map(generateListItem.bind(null,e)),a=document.createElement("ul");if(d.forEach((function(e){a.appendChild(e)})),o.appendChild(a),n.classList.remove("plus"),n.classList.add("minus"),n.textContent="-",n.addEventListener("click",collapse.bind(null,e),{once:!0}),t.shiftKey){const t=countChildren(e,l,0);console.log(t),initProgressBar(),expandAll({value:a},t,{value:2})}}function collapse(e,t){t.preventDefault(),t.stopPropagation();const n=t.target,o=n.parentElement,l=o.querySelector("ul");o.removeChild(l),n.classList.remove("minus"),n.classList.add("plus"),n.textContent="+",n.addEventListener("click",expand.bind(null,e),{once:!0})}function addOrphans(e,t){const n=document.querySelector(t),o=orphans(e);if(o.length){const t=o.map(generateListItem.bind(null,e)),l=document.createElement("ul");t.forEach((function(e){l.appendChild(e)})),n.appendChild(l)}}function expandAll(e,t,n){if(isAnchorElement(e.value)){const t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.value.dispatchEvent(t)}n.value++;updateProgressBar(100*n.value/t),e.value.children.length>0&&setTimeout((function(){for(let o=0;o<e.value.children.length;o++){expandAll({value:e.value.children[o]},t,n)}}),0)}function isAnchorElement(e){return e instanceof HTMLAnchorElement}function countChildren(e,t,n){const o=getChildren(e,t);return n++,o.length>0&&(n+=2),o.forEach((function(t){n=countChildren(e,t.id,n)+1})),n}function updateProgressBar(e){const t=document.querySelector(".progress-bar"),n=t.style.width.replace(/%/g,"");e>=parseInt(n)+2&&(t.style.width=e.toString()+"%")}function initProgressBar(){document.querySelector(".progress-bar").style.width="0%"}</script>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">CNF Certification Test Results</a>
    <div class="mb-3">
      <label for="formFile" class="form-label text-light">Upload claim.json file</label>
      <input class="form-control" type="file" id="formFile">
      <label for="selectScenarioComboBox" class="form-label text-light">
        Choose a scenario:</label>
      <select name="class" id="selectScenarioComboBox" onchange="selectScenarioHandler()">
        <option value="all"> All</option>
        <option value="faredge"> Far-Edge</option>
        <option value="telco"> Telco</option>
        <option value="nontelco"> Non-Telco</option>
        <option value="extended"> Extended</option>

      </select>
    </div>
  </nav>

  <button class="w3-button w3-right w3-light-grey" id="download" type="submit" onclick="download()" hidden>Download
    Results</button>

  <button class="w3-button w3-right w3-light-grey" id="downloadjsonHandler" type="submit" onclick="downloadjsonHandler()"
    hidden>Download Feedback as a JSON file</button>
  <p hidden id="UploadFeedback">
    Upload Feedback File: <input type="file" id="feedbackFile">
  </p>
  <div class="progress">
    <progress class="progress-bar" aria-label="progress" aria-valuenow="0" aria-valuemin="0"
      aria-valuemax="100"></progress>
  </div>
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
      <button class="nav-link active" id="config-tab" data-bs-toggle="tab" data-bs-target="#config" type="button"
        role="tab" aria-controls="config" aria-selected="true" onclick="hideAllResultsTabObjects()">Configuration</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" id="metadata-tab" data-bs-toggle="tab" data-bs-target="#metadata" type="button"
        role="tab" aria-controls="metadata" aria-selected="false" onclick="hideAllResultsTabObjects()">Metadata</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" id="nodes-tab" data-bs-toggle="tab" data-bs-target="#nodes" type="button" role="tab"
        aria-controls="nodes" aria-selected="false" onclick="hideAllResultsTabObjects()">Nodes</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" id="result-tab" data-bs-toggle="tab" data-bs-target="#results" type="button" role="tab"
        aria-controls="nodes" aria-selected="false" onclick="resfreshResultsTabContent()">Results</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" id="versions-tab" data-bs-toggle="tab" data-bs-target="#versions" type="button"
        role="tab" aria-controls="versions" aria-selected="false" onclick="hideAllResultsTabObjects()">Versions</button>
    </li>

  </ul>
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" >
      <label id="myCheck-mandatory" for="mandatory-checkbox" hidden>Show Mandatory Results for that scenario</label>
      <input type="checkbox" id="mandatory-checkbox" data-bs-target="#results" checked
        onclick="makeResultsTableVisible('mandatory')" hidden>



      <label id="myCheck-result" for="optional-checkbox" hidden>Show Optional Results for that scenario</label>
      <input type="checkbox" id="optional-checkbox" data-bs-target="#results" 
        onclick="makeResultsTableVisible('optional')" hidden>


    </li>
  </ul>
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="config" role="tabpanel" aria-labelledby="config-tab">
      <div id="config-table">
      </div>
    </div>
    <div class="table-responsive tab-pane fade" id="metadata" role="tabpanel" aria-labelledby="metadata-tab">
      <table class="table" id="metadata-table">
      </table>
    </div>
    <div class="table-responsive tab-pane fade" id="nodes" role="tabpanel" aria-labelledby="nodes-tab">
      <table class="table" id="nodes-table">
      </table>
    </div>

    <div class="tab-pane fade table-responsive" id="results" role="tabpanel" aria-labelledby="result-tab">
      <table class="table" id="results-table" hidden>
      </table>
      <table class="table" id="mandatory-far-edge-table" hidden>
      </table>
      <table class="table" id="optional-far-edge-table" hidden>
      </table>
      <table class="table" id="mandatory-telco-table" hidden>
      </table>
      <table class="table" id="optional-telco-table" hidden>
      </table>
      <table class="table" id="mandatory-non-telco-table" hidden>
      </table>
      <table class="table" id="optional-non-telco-table" hidden>
      </table>
      <table class="table" id="mandatory-extended-table" hidden>
      </table>
      <table class="table" id="optional-extended-table" hidden>
      </table>
    </div>



    <div class="table-responsive tab-pane fade" id="versions" role="tabpanel" aria-labelledby="versions-tab">
      <table class="table" id="versions-table">
      </table>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Warning</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalBody">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Stop Loading</button>
          <button type="button" id="continueLoadingClaim" data-bs-dismiss="modal"
            class="btn btn-primary">Continue</button>
        </div>
      </div>
    </div>
  </div>


  <!-- This will load the initial JSON file, if present. It may fail. -->
  <script src="./claimjson.js"></script>
  <script src="./feedback.js"></script>

</body>

</html>
